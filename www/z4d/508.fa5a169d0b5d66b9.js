"use strict";(self.webpackChunkz4d_plugin=self.webpackChunkz4d_plugin||[]).push([[508],{19508:(H,_,l)=>{l.r(_),l.d(_,{GroupModule:()=>j});var p=l(24006),f=l(44466),m=l(96749),g=l(88648),h=l(62554),U=l(22995),t=l(94650),T=l(75958),C=l(5830),d=l(54463),G=l(97185),v=l(19513),Z=l(91835),c=l(55017),x=l(10805),b=l(51740);const w=["content"];function A(o,s){if(1&o){const e=t.EpF();t._uU(0,"\n          "),t.TgZ(1,"div",12),t._uU(2,"\n            "),t.TgZ(3,"span",13),t._uU(4,"\n              "),t._UZ(5,"i",14),t._uU(6,"\n              "),t.TgZ(7,"input",15),t.NdJ("input",function(r){t.CHM(e),t.oxw();const i=t.MAs(16);return t.KtG(i.filterGlobal(r.target.value,"contains"))}),t.ALo(8,"translate"),t.qZA(),t._uU(9,"\n            "),t.qZA(),t._uU(10,"\n            "),t.TgZ(11,"button",16),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.add())}),t.qZA(),t._uU(12,"\n          "),t.qZA(),t._uU(13,"\n        ")}2&o&&(t.xp6(7),t.s9C("placeholder",t.lcZ(8,1,"device.byname.placeholder")))}function N(o,s){1&o&&(t._uU(0,"\n          "),t.TgZ(1,"tr"),t._uU(2,"\n            "),t._UZ(3,"th"),t._uU(4,"\n            "),t.TgZ(5,"th",17),t._uU(6),t.ALo(7,"translate"),t._UZ(8,"p-sortIcon",18),t._uU(9,"\n            "),t.qZA(),t._uU(10,"\n            "),t.TgZ(11,"th",19),t._uU(12),t.ALo(13,"translate"),t._UZ(14,"p-sortIcon",20),t._uU(15,"\n            "),t.qZA(),t._uU(16,"\n            "),t.TgZ(17,"th"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._uU(20,"\n            "),t.TgZ(21,"th"),t._uU(22),t.ALo(23,"translate"),t.qZA(),t._uU(24,"\n          "),t.qZA(),t._uU(25,"\n        ")),2&o&&(t.xp6(6),t.hij("\n              ",t.lcZ(7,4,"group.create.shortid.column"),""),t.xp6(6),t.hij("\n              ",t.lcZ(13,6,"group.create.groupname.column"),""),t.xp6(6),t.hij("\n              ",t.lcZ(19,8,"group.create.devices.column"),"\n            "),t.xp6(4),t.hij("\n              ",t.lcZ(23,10,"group.create.coordinator.column"),"\n            "))}function M(o,s){if(1&o){const e=t.EpF();t._uU(0,"\n                  "),t.TgZ(1,"input",29),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.GroupName=r)})("change",function(r){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.updateValue(r,i._GroupId))}),t.qZA(),t._uU(2,"\n                ")}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.GroupName)}}function E(o,s){if(1&o){const e=t.EpF();t._uU(0,"\n                  "),t.TgZ(1,"input",29),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.GroupName=r)})("change",function(r){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.updateValue(r,i._GroupId))}),t.qZA(),t._uU(2,"\n                ")}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.GroupName)}}function I(o,s){if(1&o&&(t._uU(0,"\n                  "),t.TgZ(1,"span"),t._uU(2,"\n                    "),t.TgZ(3,"b"),t._uU(4,"Widget"),t.qZA(),t._uU(5),t.TgZ(6,"b"),t._uU(7,"IEEE"),t.qZA(),t._uU(8),t.TgZ(9,"b"),t._uU(10,"Ep"),t.qZA(),t._uU(11),t.TgZ(12,"b"),t._uU(13,"Id"),t.qZA(),t._uU(14),t.TgZ(15,"b"),t._uU(16),t.qZA(),t._uU(17,"\n                  "),t.qZA(),t._uU(18,"\n                ")),2&o){const e=s.item;t.xp6(5),t.hij(" : ",e.Name," - "),t.xp6(3),t.hij(" : ",e.IEEE," - "),t.xp6(3),t.hij(" : ",e.Ep," -\n                    "),t.xp6(3),t.hij(" : ",e._ID," -\n                    "),t.xp6(2),t.Oqu(e.ZDeviceName)}}function y(o,s){if(1&o){const e=t.EpF();t._uU(0,"\n          "),t.TgZ(1,"tr"),t._uU(2,"\n            "),t.TgZ(3,"td"),t._uU(4,"\n              "),t.TgZ(5,"i",21),t.NdJ("click",function(){const i=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.delete(i))}),t.ALo(6,"translate"),t.qZA(),t._uU(7,"\n            "),t.qZA(),t._uU(8,"\n            "),t.TgZ(9,"td"),t._uU(10),t.qZA(),t._uU(11,"\n            "),t.TgZ(12,"td",22),t._uU(13,"\n              "),t.TgZ(14,"p-cellEditor"),t._uU(15,"\n                "),t.YNc(16,M,3,1,"ng-template",23),t._uU(17,"\n                "),t.YNc(18,E,3,1,"ng-template",24),t._uU(19,"\n              "),t.qZA(),t._uU(20,"\n            "),t.qZA(),t._uU(21,"\n            "),t.TgZ(22,"td"),t._uU(23,"\n              "),t.TgZ(24,"ng-select",25),t.NdJ("ngModelChange",function(r){const a=t.CHM(e).$implicit;return t.KtG(a.devicesSelected=r)})("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.isFormValid())}),t._uU(25,"\n                "),t.YNc(26,I,19,5,"ng-template",26),t._uU(27,"\n              "),t.qZA(),t._uU(28,"\n            "),t.qZA(),t._uU(29,"\n            "),t.TgZ(30,"td"),t._uU(31,"\n              "),t.TgZ(32,"div",27),t._uU(33,"\n                "),t.TgZ(34,"input",28),t.NdJ("click",function(r){const a=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.updateCoordinator(r,a))}),t.qZA(),t._uU(35,"\n              "),t.qZA(),t._uU(36,"\n            "),t.qZA()()}if(2&o){const e=s.$implicit,n=t.oxw();t.xp6(5),t.s9C("title",t.lcZ(6,9,"group.create.delete.button")),t.xp6(5),t.hij("\n              ",e._GroupId,"\n            "),t.xp6(2),t.Q6J("pEditableColumn",e.GroupName),t.xp6(12),t.Q6J("items",n.devices)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("ngModel",e.devicesSelected),t.xp6(10),t.Q6J("checked",e.coordinatorInside)}}function q(o,s){if(1&o){const e=t.EpF();t._uU(0,"\n    "),t.TgZ(1,"div",30),t._uU(2,"\n      "),t._UZ(3,"h4",31),t._uU(4,"\n      "),t.TgZ(5,"button",32),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.KtG(i.dismiss("Cross click"))}),t.qZA(),t._uU(6,"\n    "),t.qZA(),t._uU(7,"\n    "),t._UZ(8,"div",33),t._uU(9,"\n    "),t.TgZ(10,"div",34),t._uU(11,"\n      "),t.TgZ(12,"button",35),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.KtG(i.dismiss("cancel"))}),t.qZA(),t._uU(13,"\n    "),t.qZA(),t._uU(14,"\n  ")}}const S=function(){return["_GroupId","GroupName"]},J=function(){return[10,25,50]},k=new g.Yd("GroupComponent"),F=[{path:"",component:(()=>{class o extends U.n{constructor(e,n,r,i,a,u){super(),this.modalService=e,this.apiService=n,this.formBuilder=r,this.translate=i,this.toastr=a,this.headerService=u,this.rows=[],this.rowsTemp=[],this.temp=[],this.hasEditing=!1,this.waiting=!1}ngOnInit(){this.apiService.getZGroupDevicesAvalaible().subscribe(e=>{const n=[];e&&e.length>0&&(e.forEach(r=>{r.WidgetList.forEach(i=>{if("0000"!==r._NwkId){const a=new h.zL;a.Ep=i.Ep,a.IEEE=i.IEEE,a.Name=i.Name,a.ZDeviceName=i.ZDeviceName,a._ID=i._ID,a._NwkId=r._NwkId,n.push(a)}})}),this.devices=[...n],this.getGroups())})}updateValue(e,n){this.hasEditing=!0,this.rows.find(i=>i._GroupId===n).GroupName=e.target.value}updateDevices(){this.rows.forEach(e=>{e.coordinatorInside&&(e.devicesSelected||(e.devicesSelected=[]),e.devicesSelected.push({Ep:"01",_NwkId:"0000"}))}),this.isFormValid&&this.apiService.putZGroups(this.rows).subscribe(e=>{k.debug(this.rows),this.hasEditing=!1,this.toastr.success(this.translate.instant("api.global.succes.saved.notify")),this.apiService.getRestartNeeded().subscribe(n=>{1===n.RestartNeeded&&(this.headerService.setRestart(!0),this.open(this.content))}),this.waiting=!0,setTimeout(()=>{this.getGroups(),this.waiting=!1},1e3)})}delete(e){const n=this.rows.indexOf(e,0);n>-1&&(this.rows.splice(n,1),this.rows=[...this.rows],this.temp=[...this.rows])}add(){const e=new h.ZA;e.GroupName="",e.coordinatorInside=!1,this.rows.push(e),this.rows=[...this.rows],this.temp=[...this.rows]}updateCoordinator(e,n){n.coordinatorInside=e.currentTarget.checked}open(e){this.modalService.open(e,{ariaLabelledBy:"modal-basic-title"}).result.then(n=>{},n=>{})}isFormValid(){let e=!0;return this.rows.forEach(n=>{n.GroupName&&(n.coordinatorInside||n.devicesSelected&&0!==n.devicesSelected.length)||(e=!1)}),!this.waiting&&e}getGroups(){this.apiService.getZGroups().subscribe(e=>{e&&e.length>0&&(e.forEach(n=>{const r=[];n.coordinatorInside=!1,n.Devices.forEach(i=>{if("0000"===i._NwkId)n.coordinatorInside=!0;else{const a=this.devices.find(u=>u._NwkId===i._NwkId&&u.Ep===i.Ep);null!=a&&r.push(a)}}),n.devicesSelected=r}),this.rows=[...e],this.temp=[...e])})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(T.FF),t.Y36(C.s),t.Y36(p.qu),t.Y36(d.sK),t.Y36(G._W),t.Y36(v.r))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-group"]],viewQuery:function(e,n){if(1&e&&t.Gf(w,5),2&e){let r;t.iGM(r=t.CRH())&&(n.content=r.first)}},features:[t.qOj],decls:32,vars:20,consts:[[1,"card"],[1,"card-header","fw-bold"],["translate","group.create.validate.button",1,"btn","btn-primary","float-end",3,"disabled","click"],[1,"card-body"],[1,"card-text",3,"innerHTML"],[1,"card-text"],["styleClass","p-datatable-sm","dataKey","_GroupId","responsiveLayout","scroll",3,"globalFilterFields","rowHover","showCurrentPageReport","currentPageReportTemplate","rowsPerPageOptions","value","rows","paginator","scrollable"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["content",""],[1,"d-flex","justify-content-between"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text",1,"w-75",3,"placeholder","input"],["translate","group.create.add.button",1,"btn","btn-primary",3,"click"],["pSortableColumn","_GroupId",2,"width","8rem"],["field","_GroupId"],["pSortableColumn","GroupName",2,"width","10rem"],["field","GroupName"],[1,"fa","fa-trash",2,"cursor","pointer",3,"title","click"],["pEditableColumnField","GroupName",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["bindLabel","Name","placeholder","Choose device","appendTo","body",3,"items","multiple","closeOnSelect","searchable","ngModel","ngModelChange","change"],["ng-option-tmp",""],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"checked","click"],["pInputText","","type","text",3,"ngModel","ngModelChange","change"],[1,"modal-header"],["id","modal-basic-title","translate","group.reloadplugin.alert.title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["translate","group.reloadplugin.alert.subject",1,"modal-body"],[1,"modal-footer"],["type","button","translate","group.reloadplugin.alert.cancel",1,"btn","btn-outline-dark",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._uU(1,"\n  "),t.TgZ(2,"div",1),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"button",2),t.NdJ("click",function(){return n.updateDevices()}),t.qZA(),t._uU(6,"\n  "),t.qZA(),t._uU(7,"\n  "),t.TgZ(8,"div",3),t._uU(9,"\n    "),t._UZ(10,"p",4),t.ALo(11,"translate"),t._uU(12,"\n    "),t.TgZ(13,"div",5),t._uU(14,"\n      "),t.TgZ(15,"p-table",6,7),t.ALo(17,"translate"),t._uU(18,"\n        "),t.YNc(19,A,14,3,"ng-template",8),t._uU(20,"\n        "),t.YNc(21,N,26,12,"ng-template",9),t._uU(22,"\n        "),t.YNc(23,y,37,11,"ng-template",10),t._uU(24,"\n      "),t.qZA(),t._uU(25,"\n    "),t.qZA(),t._uU(26,"\n  "),t.qZA(),t._uU(27,"\n\n  "),t.YNc(28,q,15,0,"ng-template",null,11,t.W1O),t._uU(30,"\n"),t.qZA(),t._uU(31,"\n")),2&e&&(t.xp6(3),t.hij("\n    ",t.lcZ(4,12,"group.create.header"),""),t.xp6(2),t.Q6J("disabled",!n.isFormValid()),t.xp6(5),t.Q6J("innerHTML",t.lcZ(11,14,"group.create.subtitle"),t.oJD),t.xp6(5),t.s9C("currentPageReportTemplate",t.lcZ(17,16,"TOTAL")),t.Q6J("globalFilterFields",t.DdM(18,S))("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(19,J))("value",n.rows)("rows",10)("paginator",!0)("scrollable",!0))},dependencies:[p.Fj,p.JJ,p.On,Z.w9,Z.ir,d.Pi,c.iA,x.jx,c.lQ,c.Wq,c.YL,c.fz,b.o,d.X$]}),o})(),data:{title:(0,g.Kl)("group")}}];let L=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(F),m.Bz]}),o})(),j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[L,f.m,p.u5]}),o})()}}]);