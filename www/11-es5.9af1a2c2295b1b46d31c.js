!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,c=new Array(t);n<t;n++)c[n]=e[n];return c}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,c=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(c,arguments,r)}else n=c.apply(this,arguments);return i(this,n)}}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{J4zT:function(t,i,a){"use strict";a.r(i),a.d(i,"GroupModule",function(){return W});var u=a("s7LF"),l=a("M0ag"),s=a("iInd"),b=a("ey9i"),d=a("H+bZ"),p=a("D0Ju"),f=a("ntpF"),h=a("QDJC"),m=a("8Y7J"),v=a("G0yt"),g=a("TSSN"),L=a("EApP"),w=a("w9WL"),y=a("wTG2"),S=a("EOQJ"),k=["table"],T=["content"];function N(e,t){if(1&e){var n=m.Ub();m.Lc(0,"\n                "),m.Tb(1,"i",22),m.ec("click",function(){m.Bc(n);var e=t.row;return m.ic().delete(e)}),m.jc(2,"translate"),m.Sb(),m.Lc(3,"\n              ")}2&e&&(m.Ab(1),m.pc("title",m.kc(2,1,"group.create.delete.button")))}function E(e,t){1&e&&m.Lc(0),2&e&&m.Nc("\n                ",t.row._GroupId,"\n              ")}function I(e,t){if(1&e){var n=m.Ub();m.Lc(0,"\n                "),m.Tb(1,"input",23),m.ec("change",function(e){m.Bc(n);var c=t.row;return m.ic().updateValue(e,c._GroupId)}),m.Sb(),m.Lc(2,"\n              ")}if(2&e){var c=t.row;m.Ab(1),m.oc("value",c.GroupName)}}function x(e,t){if(1&e&&(m.Lc(0,"\n                    "),m.Tb(1,"span",26),m.Lc(2,"\n                      "),m.Tb(3,"b"),m.Lc(4,"Widget"),m.Sb(),m.Lc(5),m.Tb(6,"b"),m.Lc(7,"IEEE"),m.Sb(),m.Lc(8),m.Tb(9,"b"),m.Lc(10,"Ep"),m.Sb(),m.Lc(11),m.Tb(12,"b"),m.Lc(13,"Id"),m.Sb(),m.Lc(14),m.Tb(15,"b"),m.Lc(16),m.Sb(),m.Lc(17,"\n                    "),m.Sb(),m.Lc(18,"\n                  ")),2&e){var n=t.item,c=t.searchTerm;m.Ab(1),m.oc("ngOptionHighlight",c),m.Ab(4),m.Nc(" : ",n.Name," - "),m.Ab(3),m.Nc(" : ",n.IEEE," - "),m.Ab(3),m.Nc(" : ",n.Ep," -\n                      "),m.Ab(3),m.Nc(" : ",n._ID," -\n                      "),m.Ab(2),m.Mc(n.ZDeviceName)}}function A(e,t){if(1&e){var n=m.Ub();m.Lc(0,"\n                "),m.Tb(1,"ng-select",24),m.ec("ngModelChange",function(e){return m.Bc(n),t.row.devicesSelected=e})("change",function(){return m.Bc(n),m.ic().isFormValid()}),m.Lc(2,"\n                  "),m.Jc(3,x,19,6,"ng-template",25),m.Lc(4,"\n                "),m.Sb(),m.Lc(5,"\n              ")}if(2&e){var c=t.row,r=m.ic();m.Ab(1),m.oc("items",r.devices)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("ngModel",c.devicesSelected)}}function O(e,t){if(1&e){var n=m.Ub();m.Lc(0,"\n                "),m.Tb(1,"div",27),m.Lc(2,"\n                  "),m.Tb(3,"input",28),m.ec("click",function(e){m.Bc(n);var c=t.row;return m.ic().updateCoordinator(e,c)}),m.Sb(),m.Lc(4,"\n                "),m.Sb(),m.Lc(5,"\n              ")}if(2&e){var c=t.row;m.Ab(3),m.oc("checked",c.coordinatorInside)}}function _(e,t){1&e&&(m.Lc(0,"\n  "),m.Tb(1,"div",29),m.Lc(2,"\n    "),m.Ob(3,"h4",30),m.Lc(4,"\n    "),m.Tb(5,"button",31),m.ec("click",function(){return t.$implicit.dismiss("Cross click")}),m.Lc(6,"\n      "),m.Tb(7,"span",32),m.Lc(8,"\xd7"),m.Sb(),m.Lc(9,"\n    "),m.Sb(),m.Lc(10,"\n  "),m.Sb(),m.Lc(11,"\n  "),m.Ob(12,"div",33),m.Lc(13,"\n  "),m.Tb(14,"div",34),m.Lc(15,"\n    "),m.Tb(16,"button",35),m.ec("click",function(){return t.$implicit.dismiss("cancel")}),m.Sb(),m.Lc(17,"\n  "),m.Sb(),m.Lc(18,"\n"))}var G,j,C,D=new b.c("GroupComponent"),J=[{path:"",component:(G=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(s,t);var i,a,u,l=o(s);function s(e,t,c,r,o,i){var a;return n(this,s),(a=l.call(this)).modalService=e,a.apiService=t,a.formBuilder=c,a.translate=r,a.toastr=o,a.headerService=i,a.rows=[],a.rowsTemp=[],a.temp=[],a.hasEditing=!1,a.waiting=!1,a}return i=s,(a=[{key:"ngOnInit",value:function(){var e=this;this.apiService.getZGroupDevicesAvalaible().subscribe(function(t){var n=[];t&&t.length>0&&(t.forEach(function(e){e.WidgetList.forEach(function(t){if("0000"!==e._NwkId){var c=new p.a;c.Ep=t.Ep,c.IEEE=t.IEEE,c.Name=t.Name,c.ZDeviceName=t.ZDeviceName,c._ID=t._ID,c._NwkId=e._NwkId,n.push(c)}})}),e.devices=[].concat(n),e.getGroups())})}},{key:"updateValue",value:function(e,t){this.hasEditing=!0,this.rows.find(function(e){return e._GroupId===t}).GroupName=e.target.value}},{key:"updateFilter",value:function(e){var t=e.target.value.toLowerCase(),n=this.temp.filter(function(e){var n=!1;return e._GroupId&&(n=-1!==e._GroupId.toLowerCase().indexOf(t)),!n&&e.GroupName&&(n=-1!==e.GroupName.toLowerCase().indexOf(t)),n||!t});this.rows=n,this.table.offset=0}},{key:"updateDevices",value:function(){var e=this;this.rows.forEach(function(e){e.coordinatorInside&&(e.devicesSelected||(e.devicesSelected=[]),e.devicesSelected.push({Ep:"01",_NwkId:"0000"}))}),this.isFormValid&&this.apiService.putZGroups(this.rows).subscribe(function(t){D.debug(e.rows),e.hasEditing=!1,e.toastr.success(e.translate.instant("api.global.succes.update.title")),e.apiService.getRestartNeeded().subscribe(function(t){t.RestartNeeded&&(e.headerService.setRestart(!0),e.open(e.content))}),e.waiting=!0,setTimeout(function(){e.getGroups(),e.waiting=!1},1e3)})}},{key:"delete",value:function(t){var n=this.rows.indexOf(t,0);n>-1&&(this.rows.splice(n,1),this.rows=e(this.rows),this.temp=e(this.rows))}},{key:"add",value:function(){var t=new p.b;t.GroupName="",t.coordinatorInside=!1,this.rows.push(t),this.rows=e(this.rows),this.temp=e(this.rows)}},{key:"updateCoordinator",value:function(e,t){t.coordinatorInside=e.currentTarget.checked}},{key:"open",value:function(e){this.modalService.open(e,{ariaLabelledBy:"modal-basic-title"}).result.then(function(e){},function(e){})}},{key:"isFormValid",value:function(){var e=!0;return this.rows.forEach(function(t){t.GroupName&&(t.coordinatorInside||t.devicesSelected&&0!==t.devicesSelected.length)||(e=!1)}),!this.waiting&&e}},{key:"getGroups",value:function(){var t=this;this.apiService.getZGroups().subscribe(function(n){n&&n.length>0&&(n.forEach(function(e){var n=[];e.coordinatorInside=!1,e.Devices.forEach(function(c){if("0000"===c._NwkId)e.coordinatorInside=!0;else{var r=t.devices.find(function(e){return e._NwkId===c._NwkId&&e.Ep===c.Ep});null!=r&&n.push(r)}}),e.devicesSelected=n}),t.rows=e(n),t.temp=e(n))})}}])&&c(i.prototype,a),u&&c(i,u),s}(h.a),G.\u0275fac=function(e){return new(e||G)(m.Nb(v.e),m.Nb(d.a),m.Nb(u.d),m.Nb(g.d),m.Nb(L.b),m.Nb(f.a))},G.\u0275cmp=m.Hb({type:G,selectors:[["app-group"]],viewQuery:function(e,t){var n;1&e&&(m.Rc(k,!0),m.Rc(T,!0)),2&e&&(m.xc(n=m.fc())&&(t.table=n.first),m.xc(n=m.fc())&&(t.content=n.first))},features:[m.xb],decls:74,vars:29,consts:[[1,"row"],[1,"col-sm-11"],[1,"card"],["translate","group.create.header",1,"card-header"],[1,"card-body"],["translate","group.create.subtitle",1,"card-title"],[1,"card-text"],[1,"col-sm"],["type","text",3,"placeholder","keyup"],[1,"col-sm-2"],["translate","group.create.add.button",1,"w-100","btn","btn-primary",3,"click"],[1,"bootstrap",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight"],["table",""],[3,"sortable","maxWidth"],["ngx-datatable-cell-template",""],["prop","_GroupId",3,"maxWidth","name"],["prop","GroupName",3,"maxWidth","name"],[3,"name","sortable"],[3,"maxWidth","name","sortable"],[1,"col-sm-1"],["translate","group.create.validate.button",1,"w-100","btn","btn-primary",3,"disabled","click"],["content",""],[1,"fa","fa-trash",2,"cursor","pointer",3,"title","click"],["autofocus","","type","text",3,"value","change"],["bindLabel","Name","placeholder","Choose device","appendTo","body",3,"items","multiple","closeOnSelect","searchable","ngModel","ngModelChange","change"],["ng-option-tmp",""],[3,"ngOptionHighlight"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"checked","click"],[1,"modal-header"],["id","modal-basic-title","translate","group.reloadplugin.alert.title",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["translate","group.reloadplugin.alert.subject",1,"modal-body"],[1,"modal-footer"],["type","button","translate","group.reloadplugin.alert.cancel",1,"btn","btn-outline-dark",3,"click"]],template:function(e,t){1&e&&(m.Tb(0,"div",0),m.Lc(1,"\n  "),m.Tb(2,"div",1),m.Lc(3,"\n    "),m.Tb(4,"div",2),m.Lc(5,"\n      "),m.Ob(6,"div",3),m.Lc(7,"\n      "),m.Tb(8,"div",4),m.Lc(9,"\n        "),m.Ob(10,"h5",5),m.Lc(11,"\n        "),m.Tb(12,"div",6),m.Lc(13,"\n          "),m.Tb(14,"div",0),m.Lc(15,"\n            "),m.Tb(16,"div",7),m.Lc(17,"\n              "),m.Tb(18,"input",8),m.ec("keyup",function(e){return t.updateFilter(e)}),m.jc(19,"translate"),m.Sb(),m.Lc(20,"\n            "),m.Sb(),m.Lc(21,"\n            "),m.Tb(22,"div",9),m.Lc(23,"\n              "),m.Tb(24,"button",10),m.ec("click",function(){return t.add()}),m.Sb(),m.Lc(25,"\n            "),m.Sb(),m.Lc(26,"\n          "),m.Sb(),m.Lc(27,"\n          "),m.Tb(28,"ngx-datatable",11,12),m.Lc(30,"\n            "),m.Tb(31,"ngx-datatable-column",13),m.Lc(32,"\n              "),m.Jc(33,N,4,3,"ng-template",14),m.Lc(34,"\n            "),m.Sb(),m.Lc(35,"\n\n            "),m.Tb(36,"ngx-datatable-column",15),m.jc(37,"translate"),m.Lc(38,"\n              "),m.Jc(39,E,1,1,"ng-template",14),m.Lc(40,"\n            "),m.Sb(),m.Lc(41,"\n            "),m.Tb(42,"ngx-datatable-column",16),m.jc(43,"translate"),m.Lc(44,"\n              "),m.Jc(45,I,3,1,"ng-template",14),m.Lc(46,"\n            "),m.Sb(),m.Lc(47,"\n            "),m.Tb(48,"ngx-datatable-column",17),m.jc(49,"translate"),m.Lc(50,"\n              "),m.Jc(51,A,6,5,"ng-template",14),m.Lc(52,"\n            "),m.Sb(),m.Lc(53,"\n            "),m.Tb(54,"ngx-datatable-column",18),m.jc(55,"translate"),m.Lc(56,"\n              "),m.Jc(57,O,6,1,"ng-template",14),m.Lc(58,"\n            "),m.Sb(),m.Lc(59,"\n          "),m.Sb(),m.Lc(60,"\n        "),m.Sb(),m.Lc(61,"\n      "),m.Sb(),m.Lc(62,"\n    "),m.Sb(),m.Lc(63,"\n  "),m.Sb(),m.Lc(64,"\n  "),m.Tb(65,"div",19),m.Lc(66,"\n    "),m.Tb(67,"button",20),m.ec("click",function(){return t.updateDevices()}),m.Sb(),m.Lc(68,"\n  "),m.Sb(),m.Lc(69,"\n"),m.Sb(),m.Lc(70,"\n\n"),m.Jc(71,_,19,0,"ng-template",null,21,m.Kc),m.Lc(73,"\n")),2&e&&(m.Ab(18),m.pc("placeholder",m.kc(19,19,"group.create.placeholder")),m.Ab(10),m.oc("rows",t.rows)("columnMode","force")("headerHeight",40)("footerHeight","auto")("limit",10)("rowHeight","auto"),m.Ab(3),m.oc("sortable",!1)("maxWidth",100),m.Ab(5),m.pc("name",m.kc(37,21,"group.create.shortid.column")),m.oc("maxWidth",100),m.Ab(6),m.pc("name",m.kc(43,23,"group.create.groupname.column")),m.oc("maxWidth",200),m.Ab(6),m.pc("name",m.kc(49,25,"group.create.devices.column")),m.oc("sortable",!1),m.Ab(6),m.pc("name",m.kc(55,27,"group.create.coordinator.column")),m.oc("maxWidth",150)("sortable",!1),m.Ab(13),m.oc("disabled",!t.isFormValid()))},directives:[g.a,w.c,w.b,w.a,y.a,u.k,u.m,y.c,S.a],pipes:[g.c],styles:[""]}),G),data:{title:Object(b.d)("group")}}],R=((C=function e(){n(this,e)}).\u0275mod=m.Lb({type:C}),C.\u0275inj=m.Kb({factory:function(e){return new(e||C)},providers:[],imports:[[s.i.forChild(J)],s.i]}),C),W=((j=function e(){n(this,e)}).\u0275mod=m.Lb({type:j}),j.\u0275inj=m.Kb({factory:function(e){return new(e||j)},imports:[[R,l.a,u.h]]}),j)}}])}();